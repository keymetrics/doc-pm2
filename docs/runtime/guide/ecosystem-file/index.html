<!DOCTYPE html>

<html class="runtime-page">

  <head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Description">
    <!-- <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"> -->
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link href="/doc-pm2/assets/img/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
    <link rel=“prefetch” href="https://fonts.googleapis.com/css?family=Roboto:400,500">
    <link rel="stylesheet" href="/doc-pm2/assets/css/styles.css">
    <link rel="stylesheet" href="/doc-pm2/assets/css/normalize.css">
    <link rel="stylesheet" href="/doc-pm2/assets/css/bundle.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
    <link rel="stylesheet" href="//unpkg.com/gitalk/dist/gitalk.css">
</head>
  <body class="test ready sticky">
      <div class="section header-section">
    <div class=" header-container">
        <div class="PM2_logo_wrapper">
            <a class="logo-container link">
                <div class="PM2_logo"></div>
            </a>
        </div>
        <div class="PM2_search search-wrapper">
            <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;"><input class="search_input ds-input" placeholder="Search documentation..." autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;"><pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: Saira, sans-serif; font-size: 18px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre><span class="ds-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;"><div class="ds-dataset-1"></div></span></span>
            <div class="PM2_search_icon"><i class="fas fa-search"></i></div>
            <div id="hits" class="algolia-results">
                <!-- Hits widget will appear here -->
            </div>
        </div>
    </div>
</div>
      <main>
          <aside class="sidebar">
    <div class="sidebar_2_wrapper">
        <div class="sidebar_2">
            <a href="/doc-pm2/runtime/overview" data-page="runtime-page">
                <div class="sidebar_2_item sidebar_2_item_runtime">
                    <img class="sidebar_2_item__image" src="/doc-pm2/assets/static/pm2-logo-r.png">
                    <div class="sidebar_2_item__text">Runtime</div>
                </div>
            </a>
            <a href="/doc-pm2/monitoring/overview" data-page="monitoring-page">
                <div class="sidebar_2_item sidebar_2_item_monitoring">
                    <img class="sidebar_2_item__image" src="/doc-pm2/assets/static/pm2-logo-m.png">
                    <div class="sidebar_2_item__text">Monitoring</div>
                </div>
            </a>
            <a href="/doc-pm2/enterprise/overview" data-page="enterprise-page">
                <div class="sidebar_2_item sidebar_2_item_enterprise">
                    <img class="sidebar_2_item__image" src="/doc-pm2/assets/static/pm2-logo-e.png">
                    <div class="sidebar_2_item__text">Enterprise</div>
                </div>
            </a>
        </div>
        <div class="main_content">
        </div>
    </div>
    <div class="sidebar-nav">

    <ul id="acc">
    
    
    
    
        <li class="">
            <a href="/doc-pm2/runtime/overview/">Overview</a>
            
        </li>
    
    
    
        <li class="">
            <a href="/doc-pm2/runtime/quick-start/">Quick Start</a>
            
        </li>
    
    
    
        <li class="active">
            <a href="/doc-pm2/runtime/guide/">Guide</a>
            
                
                    <ul>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/installation/">Installation</a></li>
                        
                        
                        <li class="active"><a href="/doc-pm2/runtime/guide/ecosystem-file/">Ecosystem File</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/process-management/">Process Management</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/log-management/">Log Management</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/startup-hook/">Startup Hook</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/load-balancing/">Load-Balancing (cluster mode)</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/development-tools/">Development Tools</a></li>
                        
                        
                        <li class=""><a href="/doc-pm2/runtime/guide/easy-deploy-with-ssh/">Easy Deploy with SSH</a></li>
                        
                    </ul>
                
            
        </li>
    
    
    
        <li class="">
            <a href="/doc-pm2/runtime/production-best-practices/">Best Practices</a>
            
                
            
        </li>
    
    
    
        <li class="">
            <a href="/doc-pm2/runtime/integration/">Integration</a>
            
                
            
        </li>
    
    
    
        <li class="">
            <a href="/doc-pm2/runtime/references/">References</a>
            
                
            
        </li>
    
    </ul>

    </div>
</aside>
          <section class="content">
              <div class="markdown-section gettings_started_block topBlock">
    <p style="display: initial;">Getting started with PM2<span class="runtime_block gettings_started_block_span">Runtime</span><span class="monitoring_block gettings_started_block_span">Monitoring</span><span class="enterprise_block gettings_started_block_span">Enterprise</span></p>
</div>
              <article id="main" class="markdown-section">
                  <div class="edit-page">
  <a rel="noopener" class="edit-page__text" target="_blank" href="http://github.com/keymetrics/doc-pm2/blob/master/_i18n/en/runtime/guide/ecosystem-file.md">Edit Page</a>
</div>
                   <h1 id="ecosystem-file">Ecosystem File</h1>

<p>When deploying on multiple server or when using multiple CLI arguments, an alternative to the command line become more conveninent for starting your apps.</p>

<p>The purpose of the ecosystem file is to gather options and environment variables of all your applications.</p>

<hr />

<h2 id="generate-a-template">Generate a template</h2>

<p>Generate an <code class="highlighter-rouge">ecosystem.config.js</code> template with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 init
</code></pre></div></div>

<p>This will generate:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apps</span> <span class="p">:</span> <span class="p">[{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s2">"app"</span><span class="p">,</span>
    <span class="na">script</span><span class="p">:</span> <span class="s2">"./app.js"</span><span class="p">,</span>
    <span class="na">env</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="s2">"development"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">env_production</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="s2">"production"</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>For more information about available properties, check the <a href="/doc-pm2/runtime/references/ecosystem-file/">ecosystem file reference</a>.</p>

<hr />

<h2 id="use-your-ecosystem-file">Use your ecosystem file</h2>

<h3 id="routine">Routine</h3>

<p>Inside the folder, add all the applications to your process list with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start
</code></pre></div></div>

<p>You can also load the ecosystem from an other folder with:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start ~/my-app/ecosystem.config.js
</code></pre></div></div>

<h3 id="only-use-a-specific-app">Only use a specific app</h3>

<p>Use your ecosystem file only on a specific application with the option <code class="highlighter-rouge">--only &lt;app_name&gt;</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start <span class="nt">--only</span> app
</code></pre></div></div>

<hr />

<h2 id="environment-variables">Environment variables</h2>

<p>You can declare multiple, each entry must be format according to <code class="highlighter-rouge">env_&lt;environment-name&gt;</code>.</p>

<p>Here, the <code class="highlighter-rouge">app</code> process can be start with two environments: <code class="highlighter-rouge">development</code> and <code class="highlighter-rouge">production</code>.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">apps</span> <span class="p">:</span> <span class="p">[{</span>
    <span class="na">name</span><span class="p">:</span> <span class="s2">"app"</span><span class="p">,</span>
    <span class="na">script</span><span class="p">:</span> <span class="s2">"./app.js"</span><span class="p">,</span>
    <span class="na">env</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="s2">"development"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">env_production</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">NODE_ENV</span><span class="p">:</span> <span class="s2">"production"</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Select one of them with the <code class="highlighter-rouge">--env</code> flag:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 start ecosystem.config.js
pm2 start ecosystem.config.js <span class="nt">--env</span> production
</code></pre></div></div>

<hr />

<h2 id="immutable-environment">Immutable environment</h2>

<p>Once added to your process list, the process environment is immutable.</p>

<p>The process environment is generated when you add a process to your process list, using:</p>
<ul>
  <li>the current environment</li>
  <li>the ecosystem file</li>
</ul>

<p>Thus, if you restart your process list having a different current environment or having a new ecosystem file, the process environment doesn’t change.</p>

<p>This behavior has been made to ensure consistency across restarts of your app.</p>

<h3 id="updating-the-environment">Updating the environment</h3>

<p>If you want to force an update, you must use <code class="highlighter-rouge">--update-env</code> :</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># refresh the environment</span>
pm2 restart ecosystem.config.js <span class="nt">--update-env</span>

<span class="c"># switch the environment</span>
pm2 restart ecosystem.config.js <span class="nt">--env</span> production <span class="nt">--update-env</span>
</code></pre></div></div>

<hr />

<h2 id="next-step">Next step</h2>

<p><a href="/doc-pm2/runtime/guide/process-management/">Process Management</a></p>

<hr />

<h2 id="questions-">Questions ?</h2>

<p>We are always happy to help with questions you might have. Search our documentation or check out answers to common questions. You can also post questions or comments to our community forum.</p>


              </article>
              <footer class="markdown-section copyright">
    <p>© 2018 Keymetrics</p>
    <ul id="footer">
        <li><a href="javascript:void(0);">Terms of Use</a></li>
        <li><a href="javascript:void(0);">Privacy Policy</a></li>

        <!-- Adds links to other languages on the post -->
        
          
        
          
            
              <li><p class="footer-list">Language: <a href="/doc-pm2/ch/runtime/guide/ecosystem-file/" >Chinese (中文版)</a></p></li>
            

            

            

          
        
    </ul>
  </footer>



          </section>

      </main>
  </body>
  <script src="https://unpkg.com/clipboard@2.0.0/dist/clipboard.min.js" type="text/javascript"></script>
  <script src="https://unpkg.com/prismjs@1.13.0/prism.js" type="text/javascript"></script>
  <script src="https://unpkg.com/prismjs/components/prism-bash.min.js" type="text/javascript"></script>
  <script src="https://unpkg.com/prismjs/components/prism-markdown.min.js" type="text/javascript"></script>
  <script src="https://unpkg.com/prismjs/components/prism-nginx.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="/doc-pm2/assets/js/prism-clipboard.js" type="text/javascript"></script>
  <!-- <script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script> -->
  <!-- <script src="/doc-pm2/assets/js/gittalk.js"></script> -->
  <script src="/doc-pm2/assets/js/keymetrics-plugins.js" type="text/javascript"></script>
  <script src="/doc-pm2/assets/js/additional.js" type="text/javascript"></script>
</html>

